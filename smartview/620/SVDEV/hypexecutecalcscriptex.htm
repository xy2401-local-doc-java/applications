<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>HypExecuteCalcScriptEx</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="dcterms.created" content="2017-02-21T15:54:47Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Oracle&reg; Smart View for Office Developer's Guide" />
<meta name="dcterms.identifier" content="E83057-02" />
<meta name="dcterms.isVersionOf" content="SVDEV" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2004, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="hyplistcalcscriptsex.htm" title="Previous" type="text/html" />
<link rel="Next" href="hypdeletecalc.htm" title="Next" type="text/html" />
<link rel="alternate" href="SVDEV.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="SVDEV.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="SVDEV.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="vba_460"></a> <span id="PAGE" style="display:none;">165/242</span> <!-- End Header -->
<h1 id="SVDEV-vba_460" class="sect1">HypExecuteCalcScriptEx</h1>
<div>
<div class="section">
<p><span class="bold">Data provider types:</span> <span>Oracle Essbase</span>, <span>Oracle Hyperion Planning</span>, <span>Oracle Planning and Budgeting Cloud</span></p>
</div>
<!-- class="section" -->
<div class="section" id="vba_460__vba_calc_br_15">
<p class="subhead1">Description</p>
<p>HypExecuteCalcScriptEx() executes the selected business rule.</p>
</div>
<!-- class="section" -->
<div class="section" id="vba_460__vba_calc_br_16">
<p class="subhead1">Syntax</p>
<p>HypExecuteCalcScriptEx(vtSheetName, vtCubeName, vtBRName, vtBRType, vtbBRHasPrompts, vtbBRNeedPageInfo, vtRTPNames(), vtRTPValues(), vtbShowRTPDlg, vtbRuleOnForm, vtbBRRanSuccessfully, vtCubeName, vtBRName, vtBRType, vtbBRHasPrompts, vtbBRNeedPageInfo, vtbBRHidePrompts, vtRTPNamesUsed, vtRTPValuesUsed )</p>
<p>ByVal vtSheetName As Variant</p>
<p>ByVal vtCubeName As Variant</p>
<p>ByVal vtBRName As Variant</p>
<p>ByVal vtBRType As Variant</p>
<p>ByVal vtbBRHasPrompts As Variant</p>
<p>ByVal vtbBRNeedPageInfo As Variant</p>
<p>ByRef vtRTPNames() As Variant</p>
<p>ByRef vtRTPValues() As Variant</p>
<p>ByVal vtbShowRTPDlg As Variant</p>
<p>ByVal vtbRuleOnForm As Variant</p>
<p>ByRef vtbBRRanSuccessfuly As Variant</p>
<p>ByRef vtCubeName As Variant</p>
<p>ByRef vtBRName As Variant</p>
<p>ByRef vtBRType As Variant</p>
<p>ByRef vtbBRHasPrompts As Variant</p>
<p>ByRef vtbBRNeedPageInfo As Variant</p>
<p>ByRef vtbBRHidePrompts As Variant</p>
<p>ByRef vtRTPNamesUsed As Variant</p>
<p>ByRef vtRTPValuesUsed As Variant</p>
</div>
<!-- class="section" -->
<div class="section" id="vba_460__vba_calc_br_17">
<p class="subhead1">Parameters</p>
<p><span class="bold">vtSheetName:</span> Input parameter; the name of worksheet on which to run the function. If vtSheetName is <code class="codeph">Null</code> or <code class="codeph">Empty</code>, the active worksheet is used.</p>
<p><span class="bold">vtCubeName:</span> Input parameter; the cube name (plan type in Planning) associated with the business rule</p>
<p><span class="bold">vtBRName:</span> Input parameter; the name of the business rule to be run</p>
<p><span class="bold">vtBRType:</span> Input parameter; the type of business rule to be run. Valid values are "graphical", "ecs", "sequence", and "native".</p>
<p><span class="bold">vtbBRHasPrompts:</span> Input parameter; the Boolean that indicates whether the business rule has RTPs</p>
<p><span class="bold">vtbNeedPageInfo:</span> Input parameter; the Boolean that indicates whether the business rule requires Page Information to be run (this information is either from HypListCalcScriptsEx or from a prior run of HypExecuteCalcScriptEx)</p>
<p><span class="bold">vtRTPNames:</span> Input parameter; the array of RTP names associated with the business rule</p>
<p><span class="bold">vtRTPValues:</span> Input parameter; the array of RTP values corresponding to the RTP names</p>
<p><span class="bold">vtbShowBRDlg:</span> Input parameter; the Boolean that indicates whether to display the Business Rules dialog to let users select the business rule (True) or to execute the business rule automatically (False). If set to True, all input parameters related to the business rule are ignored. Recommendation: Set to True when running the business rule for the first time, and thereafter set to false to automate the execution of the same business rule.</p>
<p><span class="bold">vtbRuleOnForm:</span> Input parameter; the Boolean that indicates whether the business rule is to be associated to the form open on active sheet</p>
<p><span class="bold">vtbBRRanSuccessfully:</span> Output parameter; the Boolean value that indicates whether the last business rule ran successfully</p>
<p><span class="bold">vtCubeName:</span> Output parameter; the cube name (plan types in <span>Planning</span>) associated with the last run business rule</p>
<p><span class="bold">vtBRName:</span> Output parameter; the name of the last run business rule</p>
<p><span class="bold">vtBRType:</span> Output parameter; the type of the last run business rule</p>
<p><span class="bold">vtbBRHasPrompts:</span> Output parameter; the Boolean that indicates whether the last run business rule has RTPs</p>
<p><span class="bold">vtbBRNeedPageInfo:</span> Output parameter; the Boolean that indicates whether the last run business rule requires Page information to be run</p>
<p><span class="bold">vtbBRHidePrompts:</span> Output parameter; the Boolean that indicates whether the last run business rule has hidden RTPs</p>
<p><span class="bold">vtRTPNames:</span> Output parameter; the array of RTP names used to run last run business rule</p>
<p><span class="bold">vtRTPValues:</span> Output parameter; the array of RTP values associated with RTP names used to run last run business rule</p>
</div>
<!-- class="section" -->
<div class="section" id="vba_460__vba_calc_br_18">
<p class="subhead1">Return Value</p>
<p>Returns 0 if successful; otherwise, the appropriate error code.</p>
</div>
<!-- class="section" -->
<div class="section" id="vba_460__vba_calc_br_19">
<p class="subhead1">Example</p>
<pre dir="ltr">
Public Declare Function HypExecuteCalcScriptEx Lib "HsAddin" (ByVal vtSheetName As Variant,ByVal vtCubeName As Variant,ByVal vtBRName As Variant, ByVal vtBRType As Variant, ByVal vtbBRHasPrompts As Variant, ByVal vtbBRNeedPageInfo As Variant,ByRef vtRTPNames() As Variant,ByRef vtRTPValues() As Variant, ByVal vtbShowRTPDlg As Variant, ByVal vtbRuleOnForm As Variant, ByRef vtBRRanSuccessfully As Variant,ByRef vtCubeName As Variant,ByRef vtBRName As Variant, ByRef vtBRType As Variant, ByRef vtbBRHasPrompts As Variant, ByRef vtbBRNeedPageInfo As Variant, ByRef vtbBRHidePrompts As Variant, ByRef vtRTPNamesUsed As Variant, ByRef vtRTPValuesUsed As Variant) As Long

Sub Example_HypExecuteCalcScriptEx()

Dim oRet As Long
Dim oSheetName As StringDim oSheet As Worksheet
Dim vtCubeNames As Variant
Dim vtBRNames As Variant
Dim vtBRTypes As Variant
Dim vtBRHasPrompts As Variant
Dim vtBRNeedsPageInfo As Variant
Dim vtBRHidePrompts As Variant
Dim sAllCalcs As String
Dim sCalcName As String
Dim bNeedPageInfo As Variant
Dim vtInRTPNames() As Variant
Dim vtInRTPValues() As Variant
Dim vtOutRTPNames As Variant
Dim vtOutRTPValues As Variant
Dim vtbBRRanSuccessfully As Variant
Dim vtbBRRanSuccessfully2 As Variant
Dim vtOutCubeName As Variant
Dim vtOutBRName As Variant
Dim vtOutBRType As Variant
Dim bBRHasPrompts As Variant
Dim bBRNeedPageInfo As Variant
Dim bBRHidePrompts As Variant
Dim bShowDlg As Variant
Dim bRuleOnForm As Variant

'Set oSheet = ActiveSheet
'oSheetName = oSheet.Name
oSheetName = "Sheet3"

oRet = HypListCalcScriptsEx (oSheetName, False, vtCubeNames, vtBRNames, vtBRTypes, vtBRHasPrompts, vtBRNeedsPageInfo, vtBRHidePrompts)
If (oRet = 0) Then
    If IsArray(vtBRNames) Then
        lNumMbrs = (UBound(vtBRNames) - LBound(vtBRNames) + 1)
    End If

    sPrintMsg = "Number of Calc Scripts = " &amp; lNumMbrs
    MsgBox (sPrintMsg)

    'Start Executing the Calc Script

    bShowDlg = True
    bRuleOnForm = False
    iScript = 1

    oRet = HypExecuteCalcScriptEx (oSheetName, vtCubeNames(iScript), vtBRNames(iScript),  vtBRTypes(iScript), vtBRHasPrompts(iScript), vtBRNeedsPageInfo(iScript), vtInRTPNames, vtInRTPValues, bShowDlg, bRuleOnForm, vtbBRRanSuccessfully, vtOutCubeName, vtOutBRName, vtOutBRType,bBRHasPrompts, bBRNeedPageInfo, bBRHidePrompts, vtOutRTPNames, vtOutRTPValues)
    If (oRet = 0) Then
        MsgBox ("Last BR ran successfully -  " &amp; vtbBRRanSuccessfully)

        If (vtbBRRanSuccessfully = True) Then
            bShowDlg = False
            bRuleOnForm = False

            If IsArray(vtOutRTPNames) And IsArray(vtOutRTPValues) Then
                lNumRTPNames = (UBound(vtOutRTPNames) - LBound(vtOutRTPNames) + 1)
                lNumRTPVals = (UBound(vtOutRTPValues) - LBound(vtOutRTPValues) + 1)
            End If

            If (lNumRTPNames &gt; 0) Then
                ReDim vtInRTPNames(lNumRTPNames - 1) As Variant
                ReDim vtInRTPValues(lNumRTPNames - 1) As Variant

                For iRTPs = 0 To lNumRTPNames - 1
                    sBRName = vtOutRTPNames(iRTPs)
                    sBRVal = vtOutRTPValues(iRTPs)

                    vtInRTPNames(iRTPs) = sBRName
                    vtInRTPValues(iRTPs) = sBRVal
                Next iRTPs
            End If

            oRet = HypExecuteCalcScriptEx (oSheetName, vtOutCubeName, vtOutBRName, vtOutBRType, bBRHasPrompts, bBRNeedPageInfo, vtInRTPNames, vtInRTPValues, bShowDlg, bRuleOnForm, vtbBRRanSuccessfully2, vtOutCubeName,  vtOutBRName, vtOutBRType, bBRHasPrompts, bBRNeedPageInfo, bBRHidePrompts, vtOutRTPNames, vtOutRTPValues)
            MsgBox ("Automated BR ran successfully -  " &amp; vtbBRRanSuccessfully2)
        End If
    Else
        sPrintMsg = "Error - " &amp; oRet
        MsgBox (sPrintMsg)
    End If
Else
    sPrintMsg = "Error - " &amp; oRet
    MsgBox (sPrintMsg)
End If

End Sub
</pre></div>
<!-- class="section" -->
<div class="section" id="vba_460__vba_calc_br_20">
<p class="subhead1">Usage</p>
<p>You can use HypExecuteCalcScriptEx in four modes, depending on whether HypListCalcScriptsEx is called before HypExecuteCalcScriptEx.</p>
<p><span class="bold"><span class="italic">Not</span> Calling HypListCalcScriptsEx Before HypExecuteCalcScriptEx</span></p>
<p>If you do <span class="italic">not</span> call HypListCalcScriptsEx before HypExecuteCalcScriptEx, then the first time you call HypListCalcScriptsEx you should set vtbShowBRDlg to True for the first usage and to False thereafter.</p>
<ul style="list-style-type: disc;">
<li>
<p>Mode 1: When vtbShowBRDlg is <span class="bold">True</span>:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Input Arguments:</span> vtSheetName, vtCubeName, vtbRuleOnForm are used. vtBRName, vtBRType, vtbBRHasPrompts, vtbNeedPageInfo, ppRTPNames, ppRTPValues are ignored.</p>
</li>
<li>
<p><span class="bold">Behavior</span>: The <span class="bold">Business Rules</span> dialog box displays all possible rules depending upon the vtbRuleOnForm value. When the user, runs the selected business rule and exits the <span class="bold">Business Rules</span> dialog box, the details of that business rule are filled in the out arguments and returned to the caller.</p>
</li>
<li>
<p><span class="bold">Output arguments</span>: All out arguments are filled and returned to the caller so that they can be used in subsequent calls.</p>
</li>
</ul>
</li>
<li>
<p>Mode 2: When vtbShowBRDlg argument is <span class="bold">False</span>:</p>
<ul style="list-style-type: disc;">
<li>
<p><span class="bold">Input arguments</span>: All input arguments are used.</p>
</li>
<li>
<p><span class="bold">Behavior:</span> The <span class="bold">Business Rules</span> dialog box is not displayed. The business rule is run automatically, and the appropriate status is returned to the caller.</p>
</li>
<li>
<p><span class="bold">Output arguments</span>: All output arguments are left unmodified, because nothing needs to be passed on to the caller, who already has all the information to run this particular business rule.</p>
</li>
</ul>
</li>
</ul>
<p><span class="bold">Calling HypListCalcScriptsEx Before HypExecuteCalcScriptEx</span></p>
<p>If you <span class="italic">do</span> call HypListCalcScriptsEx before HypExecuteCalcScriptEx, then when HypListCalcScriptsEx is called, users get information about all business rules and runtime prompts, if any.</p>
<p>If a user runs a business rule that has no RTP, HypExecuteCalcScriptEx can be called with vtbShowBRDlg argument as False and provides all other information as the input arguments.</p>
<p>If a user runs a business rule that has an RTP, HypExecuteCalcScriptEx must be called with vtbShowBRDlg as True so that the business rule and its RTPs can be displayed and the user can select the RTP values to run the business rule. (In<span>Planning</span>, the RTP flag may be True for a business rule when there are no RTPs to be displayed.)</p>
<ul style="list-style-type: disc;">
<li>
<p>Mode 3: If the cube name, business rule name and business rule type are passed as empty in HypExecuteCalcScriptEx, the <span class="bold">Business Rules</span> dialog box is displayed and all business rules are shown, depending upon vtbRuleOnForm argument. All else is the same as mode 1.</p>
</li>
<li>
<p>Mode 4: If the cube name, business rule name and business rule type are passed with filled values in HypExecuteCalcScriptEx, the <span class="bold">Business Rules</span> dialog box is displayed and only the passed business rule (business rule name for the provided cube name) is displayed along with its RTPs. All else is the same as mode 1.</p>
</li>
</ul>
</div>
<!-- class="section" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment17">
<tr>
<td class="cellalignment24">
<table class="cellalignment22">
<tr>
<td class="cellalignment21"><a href="hyplistcalcscriptsex.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment21"><a href="hypdeletecalc.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2004, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment26">
<table class="cellalignment20">
<tr>
<td class="cellalignment21"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment21"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
