<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Creating Functions in the Function Builder</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="dcterms.created" content="2018-06-21T15:05:18Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Oracle&reg; Smart View for Office User's Guide" />
<meta name="dcterms.identifier" content="E96983-02" />
<meta name="dcterms.isVersionOf" content="SVXYZ" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2004, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="creating_functions.htm" title="Previous" type="text/html" />
<link rel="Next" href="using_cell_references.htm" title="Next" type="text/html" />
<link rel="alternate" href="SVXYZ.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="functions495503"></a> <span id="PAGE" style="display:none;">592/650</span> <!-- End Header -->
<h1 id="SVXYZ-functions495503" class="sect1">Creating Functions in the Function Builder</h1>
<div>
<div class="section">
<p>In the Function Builder, you select a function and specify the connection and members that you want the function to use. The Function Builder then creates the function using the proper syntax and enters it into the selected cell. You can edit these functions.</p>
<p>The selections available to you in a given Function Builder field are limited by your selections in other fields of the Function Builder. For example, only the connections supported by the selected function are displayed, and only the dimensions supported by the function you select are displayed.</p>
<p>A cell reference can be selected for each function argument. If you know argument input values, you can create functions in offline mode. Type-in functionality is available for each argument.</p>
<p><a href="function_descriptions.htm#functions_33">Function Descriptions</a></p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<p>You can use functions that were created in the Function Builder prior to Release 11.1.2.2.310. However, starting with Release 11.1.2.2.310, the Function Builder uses commas (,) to separate member list arguments rather than semicolons (;). Both characters are supported by the new Function Builder, but when you modify a function created in the previous version, you are prompted to convert to the new comma-separated format. If you choose not to convert, then none of your modifications to the function are applied.</p>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p>To create functions using the Function Builder:</p>
</div>
<!-- class="section" -->
<ol id="functions495503__functions496877">
<li class="stepexpand" id="functions495503__functions496878"><span>Connect to the appropriate data source.</span>
<div>
<p>Function Builder supports shared or private connections.</p>
<p><span class="bold"><span class="props_platform_onpremise"><span>Oracle Essbase</span>, <span>Oracle Analytics Cloud - Essbase</span></span>:</span> If you are using a private connection, and your function is going to use an alias table, you must verify that the correct alias table or the <span class="q">"Default"</span> alias table is set for the connection. In the <span>Smart View Panel</span>, right-click the database name, and select <span class="bold">Set alias table</span>. Ensure that the correct alias table is selected, and then refresh the sheet.</p>
</div>
</li>
<li class="stepexpand" id="functions495503__functions_37"><span>In the sheet, select the cell in which you want to enter the function.</span></li>
<li class="stepexpand" id="functions495503__functions_85"><span>In the <span>Smart View Panel</span>, navigate to the database on which you want to base the function, right-click the database name, and then select <span class="bold">Build Function</span>.</span>
<div>
<p>Accessing the Function Builder in this way will prepopulate the <span class="bold">Connection</span> field of the <span class="bold">Function Arguments</span> dialog box with specific connection information, as described in step <a href="f_fnc_bd.htm#functions495503__functions496881">4</a>.</p>
<p>Alternatively, from the <span>Oracle Smart View for Office</span> ribbon, select <span class="bold">Functions,</span> and then <span class="bold">Build Function</span>.</p>
<p>When you access the Function Builder in this way, the <span class="bold">Connection</span> field in the <span class="bold">Function Arguments</span> dialog box is blank. You may provide connection information, as described in step <a href="f_fnc_bd.htm#functions495503__functions496881">4</a>. Or, if there is an active connection on the sheet, select HSACTIVE from the drop-down list.</p>
</div>
</li>
<li class="stepexpand" id="functions495503__functions496881"><span>In <span class="bold">Select Function</span>, select a function from the list and click <span class="bold">OK</span>.</span>
<div>
<div class="figure" id="functions495503__functions_64">
<p class="titleinfigure">Figure 24-1 Function Builder, Select Function Dialog Box</p>
<br />
<img width="378" height="283" src="img/function_builder1.jpg" alt="The Function Builder, Select Function dialog box, with HsGetValue, selected as described in this section" title="The Function Builder, Select Function dialog box, with HsGetValue, selected as described in this section" /><br /></div>
<!-- class="figure" -->
<div class="infobox-note">
<p class="notep1">Note:</p>
<p>Not all functions are available to all providers. See <a href="using_functions.htm#functions_48__functions_99" title="Lists functions, a short description of the function, and the providers that support the function">Table 24-1</a> for a list of functions and the supported providers.</p>
</div>
<p>The <span class="bold">Function Arguments</span> dialog box is displayed with the <span class="bold">Connection</span> field automatically populated with connection information in one of the following formats.</p>
<ul style="list-style-type: disc;">
<li>
<p>For shared connections:</p>
<pre dir="ltr">
WSFN|<span class="variable">ProviderType</span>|<span class="variable">Server</span>|<span class="variable">Application</span>|<span class="variable">Database</span>
</pre>
<p>The <code class="codeph">WSFN</code> parameter above signifies that this function is a workspace function and uses a shared connection. Workspace functions support <span class="props_platform_onpremise"><span>Oracle Hyperion Enterprise Performance Management Workspace</span> or</span> <span>Oracle Enterprise Performance Management Cloud</span> connections.</p>
</li>
<li>
<p>For private connections:</p>
<pre dir="ltr">
<span class="variable">PrivateConnectionName</span>
</pre></li>
</ul>
<p>To manually enter the connection info, use the syntax above.</p>
</div>
</li>
<li class="stepexpand" id="functions495503__functions_65"><span>In <span class="bold">Function Arguments</span>, for each argument in the selected function, do one of the following:</span>
<div>
<ul style="list-style-type: disc;">
<li>
<p>Click the right-most button, <img width="20" height="20" src="img/function_builder_button2.jpg" alt="Member Selection button, opens the Member Selection dialog box" title="Member Selection button, opens the Member Selection dialog box" />.</p>
<p>For example, for HsGetValue, click <img width="20" height="20" src="img/function_builder_button2.jpg" alt="Member Selection button, opens the Member Selection dialog box" title="Member Selection button, opens the Member Selection dialog box" /> to select members from <span class="bold">Member Selection</span>; for HsLabel and HsGetVariable, select from drop-down lists of labels or variables.</p>
<p><span class="bold"><span class="props_platform_onpremise"><span>Essbase</span>, <span>Oracle Analytics Cloud - Essbase</span></span>:</span> Note that when variable names are duplicated, their fully qualified name is displayed in the drop-down list. This helps to identify variables defined at the global, application, and database levels.</p>
</li>
<li>
<p>To type arguments manually, enter the argument in the text box. For example, to type a member, use the format: dimension#member; such as <code class="codeph">Year#Qtr1</code> or <code class="codeph">Year#Jan</code>.</p>
</li>
<li>
<p>To use cell references, follow the procedure in <a href="using_cell_references.htm#functions_71">Using Cell References</a>.</p>
</li>
</ul>
<p><a href="f_fnc_bd.htm#functions495503__functions_78">Figure 24-2</a> shows a completed <span class="bold">Function Arguments</span> dialog box for the HsGetValue function.</p>
<div class="figure" id="functions495503__functions_78">
<p class="titleinfigure">Figure 24-2 Function Builder, Function Arguments Dialog Box for HsGetValue Based on the Essbase Sample Basic Database</p>
<br />
<img width="515" height="270" src="img/function_builder2a.jpg" alt="The Function Builder, Function Arguments dialog box for the HsGetValue function. There is a Connection field and fields for entering dimensions and members for each function argument." title="The Function Builder, Function Arguments dialog box for the HsGetValue function. There is a Connection field and fields for entering dimensions and members for each function argument." /><br /></div>
<!-- class="figure" -->
<p>The arguments listed in <span class="bold">Function Arguments</span> vary depending on the function selected in the previous step.</p>
<p><span class="bold">Notes:</span></p>
<ul style="list-style-type: disc;">
<li>
<p>For HsGetSheetInfo, use a cell reference. See <a href="using_cell_references.htm#functions_71">Using Cell References</a> for more information.</p>
</li>
<li>
<p>For HsSetValue only: Select <span class="bold">Data</span> or <span class="bold">Cell Reference</span> and enter the value to submit.</p>
</li>
<li>
<p>For HsGetText and HsSetText only:</p>
<ul style="list-style-type: disc;">
<li>
<p>Select <span class="bold">Comments</span> or <span class="bold">Cell Reference</span>, and then enter the cell text to submit</p>
</li>
<li>
<p>Select <span class="bold">Cell Text Label</span>, and then select a label from the drop-down menu</p>
</li>
</ul>
</li>
<li>
<p>If an active worksheet connection is available, you can select <span class="bold">HSACTIVE</span> from the <span class="bold">Connection</span> drop-down list.</p>
</li>
</ul>
</div>
</li>
<li class="stepexpand" id="functions495503__functions_91"><span>Click <span class="bold">Validate</span> and correct any errors that may be noted.</span>
<div>
<p>Some of the errors you may see are:</p>
<ul style="list-style-type: disc;">
<li>
<p>Connection offline or invalid</p>
</li>
<li>
<p>Invalid selection</p>
</li>
<li>
<p>Member name is invalid or not matching selected alias</p>
</li>
<li>
<p>Dimension name is invalid or not matching selected alias</p>
</li>
<li>
<p>Incomplete Dimension#Member combination</p>
</li>
<li>
<p>Generic <span class="q">"Error"</span> in cases of missing quotation marks or other minor syntax errors</p>
</li>
</ul>
<p><a href="f_fnc_bd.htm#functions495503__functions_93">Figure 24-3</a> shows errors in the Function Arguments dialog box with after clicking the <span class="bold">Validate</span> button. In the following example from the <span>Oracle Hyperion Financial Management</span> Simple application, there are errors in the syntax for two of the Dimension#Member combinations. The first error is that the Dimension name is invalid or not matching the selected alias. The second error is that the member name is invalid or not matching the selected alias.</p>
<div class="figure" id="functions495503__functions_93">
<p class="titleinfigure">Figure 24-3 Function Builder Validation Errors</p>
<br />
<img width="720" height="273" src="img/function_builder_validation.jpg" alt="The Function Builder, Function Arguments dialog box for the HsGetValue function. There are errors in the syntax for two of the Dimension#Member combinations. The first error is that the Dimension name is invalid or not matching the selected alias. The second error is that the member name is invalid or not matching the selected alias." title="The Function Builder, Function Arguments dialog box for the HsGetValue function. There are errors in the syntax for two of the Dimension#Member combinations. The first error is that the Dimension name is invalid or not matching the selected alias. The second error is that the member name is invalid or not matching the selected alias." /><br /></div>
<!-- class="figure" --></div>
</li>
<li class="stepexpand" id="functions495503__functions_66"><span>When the function validation is successful, click <span class="bold">OK</span> to insert the function in the selected cell.</span></li>
<li class="stepexpand" id="functions495503__functions496947"><span>To execute the function, follow the procedure in <a href="running_functions.htm#functions497051">Running Functions</a>.</span></li>
</ol>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment34">
<tr>
<td class="cellalignment41">
<table class="cellalignment39">
<tr>
<td class="cellalignment38"><a href="creating_functions.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment38"><a href="using_cell_references.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2004, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment43">
<table class="cellalignment37">
<tr>
<td class="cellalignment38"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment38"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
