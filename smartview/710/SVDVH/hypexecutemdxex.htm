<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>HypExecuteMDXEx</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="dcterms.created" content="2017-11-11T17:07:08Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Oracle&reg; Smart View for Office Developer's Guide" />
<meta name="dcterms.identifier" content="E91405-01" />
<meta name="dcterms.isVersionOf" content="SVDVH" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2004, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="about_mdx.htm" title="Previous" type="text/html" />
<link rel="Next" href="journals_functions_102xb3f9b36c.htm" title="Next" type="text/html" />
<link rel="alternate" href="SVDVH.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="vba_933"></a> <span id="PAGE" style="display:none;">229/273</span> <!-- End Header -->
<h1 id="SVDVH-vba_933" class="sect1">HypExecuteMDXEx</h1>
<div>
<div class="section">
<p><span class="props_platform_onpremise"><span class="bold">Cloud data provider types:</span></span> <span>Oracle Analytics Cloud - Essbase</span></p>
<p class="props_platform_onpremise"><span class="bold">On-premises data provider types:</span> <span>Oracle Essbase</span></p>
</div>
<!-- class="section" -->
<div class="section" id="vba_933__vba_mdx_1">
<p class="subhead1">Description</p>
<p>HypExecuteMDXEx() executes an MDX query whose results are output in a data structure but are not displayed on the worksheet. (If you want to display the query results on a worksheet, use HypExecuteQuery instead.)</p>
</div>
<!-- class="section" -->
<div class="section" id="vba_933__vba_mdx_2">
<p class="subhead1">Syntax</p>
<pre dir="ltr">
HypExecuteMDXEx 
(
ByVal vtSheetName As Variant,
ByVal vtQuery As Variant, 
ByVal vtBoolHideData As Variant,
ByVal vtBoolDataLess As Variant,
ByVal vtBoolNeedStatus As Variant,
ByVal vtMbrIDType As Variant, 
ByVal vtAliasTable As Variant, 
ByRef outResult As MDX_AXES_NATIVE
) As Long
</pre></div>
<!-- class="section" -->
<div class="section" id="vba_933__vba_mdx_3">
<p class="subhead1">Parameters</p>
<p><span class="bold">vtSheetName:</span> The name of worksheet on which to run the function. If vtSheetName is <code class="codeph">Null</code> or <code class="codeph">Empty</code>, the active worksheet is used.</p>
<p><span class="bold">vtQuery:</span> The MDX query to be executed</p>
<p><span class="bold">vtBoolHideData:</span> The Boolean flag to hide or unhide data in the result</p>
<p><span class="bold">vtBoolDataLess:</span> The Boolean flag to get or avoid data in the result</p>
<p><span class="bold">vtBoolNeedStatus:</span> The Boolean flag to get or avoid status info in the result</p>
<p><span class="bold">vtMbrIDType:</span> The member type identifier for the result (name or alias)</p>
<p><span class="bold">vtAliasTable:</span> The alias table to be used</p>
<p><span class="bold">outResult:</span> Pointer to a structure of type MDX_AXES. It contains the query output. (See <a href="hypexecutemdxex.htm#vba_933__vba_mdx_5">Data Types Specific to HypExecuteMDXEx</a> for data types and support functions for this API.)</p>
</div>
<!-- class="section" -->
<div class="section" id="vba_933__vba_mdx_4">
<p class="subhead1">Return Value</p>
<p>Returns 0 if successful; otherwise, returns the appropriate error code.</p>
</div>
<!-- class="section" -->
<div class="section" id="vba_933__vba_mdx_5">
<p class="subhead1">Data Types Specific to HypExecuteMDXEx</p>
<p>The following data types apply exclusively to HypExecuteMDXEx:</p>
<p>MDX_CELL: The data type corresponding to a cell</p>
<p>MDX_PROPERTY: The data type containing properties info for members and dimensions</p>
<p>MDX_MEMBER: The data type for members information</p>
<p>MDX_DIMENSION: The data type for dimensions information</p>
<p>MDX_CLUSTER: The data type for cluster information</p>
<p>MDX_AXIS: The data type representing an axis</p>
<p>MDX_AXES: The root level structure containing a collection of axes and cells</p>
<p>MDX_AXES_NATIVE: The data type used as an out parameter for HypExecuteMDXEx. This structure should be converted to MDX_AXES using procedure GetVBCompatibleMDXStructure.</p>
</div>
<!-- class="section" -->
<div class="section" id="vba_933__vba_mdx_6">
<p class="subhead1">Example</p>
<pre dir="ltr">
Sub GetVBCompatibleMDXStructure(ByRef inStruct As MDX_AXES_NATIVE, ByRef outStruct As MDX_AXES)

Public Declare Function HypExecuteMDXEx Lib "HsAddin" (ByVal vtSheetName As Variant, ByVal vtQuery As Variant, ByVal vtBoolHideData As Variant, ByVal vtBoolDataLess As Variant, ByVal vtBoolNeedStatus As Variant, ByVal vtMbrIDType As Variant, ByVal vtAliasTable As Variant, ByRef outResult As MDX_AXES_NATIVE) As Long

Sub Example_HypExecuteMDXEx()

Dim Query As Variant
Dim vtBoolHideData As Variant
Dim vtBoolDataLess As Variant
Dim vtBoolNeedStatus As Variant
Dim vtMbrIDType As Variant
Dim vtAliasTable As Variant
Dim result_Native As MDX_AXES_NATIVE
Dim result_VBCompatible As MDX_AXES

Query = "select {Jan} on COLUMNS, {Profit} on ROWS from Sample.Basic"
vtBoolHideData = True
vtBoolDataLess = True
vtBoolNeedStatus = True
vtMbrIDType = "alias"
vtAliasTable = "none"

sts = HypConnect(Empty, "<span class="variable">UserName</span>", "<span class="variable">Password</span>", "SB")

If sts = 0 Then

sts = HypExecuteMDXEx(Empty, Query, vtBoolHideData, vtBoolDataLess, vtBoolNeedStatus, vtMbrIDType, vtAliasTable, result_Native)
sts = GetVBCompatibleMDXStructure(result_Native, result_VBCompatible)
sts = HypDisconnect(Empty, True)
Else
End If
End Sub
</pre></div>
<!-- class="section" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment1">
<tr>
<td class="cellalignment8">
<table class="cellalignment6">
<tr>
<td class="cellalignment5"><a href="about_mdx.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment5"><a href="journals_functions_102xb3f9b36c.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2004, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment10">
<table class="cellalignment4">
<tr>
<td class="cellalignment5"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment5"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
