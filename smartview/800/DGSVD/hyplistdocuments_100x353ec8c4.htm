<!DOCTYPE html>
<html lang="en" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<title>HypListDocuments</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="dcterms.created" content="2018-06-08T15:27:38Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Oracle&reg; Smart View for Office Developer's Guide" />
<meta name="dcterms.identifier" content="E97278-01" />
<meta name="dcterms.isVersionOf" content="DGSVD" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;2004, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="hypgetsheetinfo_107x78a8472e.htm" title="Previous" type="text/html" />
<link rel="Next" href="connection_functions.htm" title="Next" type="text/html" />
<link rel="alternate" href="DGSVD.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-895607D3-0AB0-4DA1-9F87-C6E7856A2F3E"></a> <span id="PAGE" style="display:none;">84/274</span> <!-- End Header -->
<h1 id="DGSVD-GUID-895607D3-0AB0-4DA1-9F87-C6E7856A2F3E" class="sect1">HypListDocuments</h1>
<div>
<div class="section" id="GUID-895607D3-0AB0-4DA1-9F87-C6E7856A2F3E__section-121-353e724e">
<p><span class="props_platform_onpremise"><span class="bold">Cloud data provider types:</span></span> <span>Oracle Planning and Budgeting Cloud</span></p>
<p class="props_platform_onpremise"><span class="bold">On-premises data provider types:</span> <span>Oracle Hyperion Planning</span>, <span>Oracle Hyperion Financial Management</span></p>
</div>
<!-- class="section" -->
<div class="section" id="GUID-895607D3-0AB0-4DA1-9F87-C6E7856A2F3E__section-122-353e9881">
<p class="subhead1">Description</p>
<p>HypListDocuments returns a list of folders and forms that are saved on the provider server, in the path specified by the user.</p>
<div class="infobox-note">
<p class="notep1">Note:</p>
<p>In descriptions for this function, folders and forms are referred to as documents.</p>
</div>
<p>Unlike other VBAs, this is not a sheet-specific function. Sheet information is optional for this function. Refer to <a href="hyplistdocuments_100x353ec8c4.htm#GUID-895607D3-0AB0-4DA1-9F87-C6E7856A2F3E__section-124-36ccf4cc">Parameters</a>.</p>
</div>
<!-- class="section" -->
<div class="section" id="GUID-895607D3-0AB0-4DA1-9F87-C6E7856A2F3E__section-123-353f1671">
<p class="subhead1">Syntax</p>
<p>HypListDocuments (vtSheetName, vtUserName, vtPassword, vtConnInfo, vtCompletePath, vtDocs)</p>
<p>ByVal vtSheetName As Variant</p>
<p>ByVal vtUserName As Variant</p>
<p>ByVal vtPassword As Variant</p>
<p>ByVal vtConnInfo As Variant</p>
<p>ByVal vtCompletePath As Variant</p>
<p>ByRef vtDocs As DOC_Info</p>
<p>DOC_Info is in turn defined as the following type :</p>
<p>Type DOC_Info</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>numDocs As Long</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>docTypes As Variant</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>docNames As Variant</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>docDescriptions As Variant</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>docPlanTypes As Variant</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>docAttributes As Variant</p>
<p>End Type</p>
See further descriptions below in <a href="hyplistdocuments_100x353ec8c4.htm#GUID-895607D3-0AB0-4DA1-9F87-C6E7856A2F3E__section-124-36ccf4cc">Parameters</a>.</div>
<!-- class="section" -->
<div class="section" id="GUID-895607D3-0AB0-4DA1-9F87-C6E7856A2F3E__section-124-36ccf4cc">
<p class="subhead1">Parameters</p>
<p><span class="bold">vtSheetName:</span> Optional. The name of the worksheet which will be used to obtain connection information, if vtConnInfo is empty. If vtSheetName is also empty, the active data source will be used to obtain connection information.</p>
<p><span class="bold">vtUserName:</span> Optional input parameter. Used to connect using the given connection info (vtConnInfo/vtSheetName). Not necessary to be given if user is sure that the connection already exists.</p>
<p><span class="bold">vtPassword:</span> Optional input parameter. Used to connect using the given connection info (vtConnInfo/vtSheetName). Not required if user is sure that the connection already exists.</p>
<p><span class="bold">vtConnInfo:</span> Optional input parameter. Connection information, given either in the form of a friendly private connection name, or in the format accepted by HypConnect() or HypUIConnect(). If vtConnInfo is empty, vtSheetName is used to obtain connection info. If both are empty, the active data source is used.</p>
<p><span class="bold">vtCompletePath:</span> Mandatory input parameter. The folder path within the server for which the document list is needed.</p>
<p><span class="bold">vtDocs:</span> Mandatory output parameter. The list of documents (files and folders) present inside the given vtCompletePath, returned from the VBA.</p>
<p><span class="bold">DOC_Info Structure Definitions</span></p>
<p><span class="bold">numDocs:</span> Number of folders plus the number of forms in the given folder. Defines the length of each of the arrays noted below.</p>
<p><span class="bold">docTypes:</span> An array of strings. Array defining the type of each of the documents. Two types are supported, <span class="q">"DOC_FORM"</span> and <span class="q">"DOC_FOLDER"</span>. Two global constants define the two types, which can be used to compare these values with the ones in the array</p>
<pre dir="ltr">
Global Const HYP_LIST_DOC_FORM = "DOC_FORM"
Global Const HYP_LIST_DOC_FOLDER = "DOC_FOLDER"
</pre>
<p>See <a href="hyplistdatabases_105x78a7eea3.htm#GUID-505ACBA5-70D2-41CE-A0A8-0F88D72645D1__section-1-78A78ADB">Example</a> for usage.</p>
<p><span class="bold">docNames:</span> An array of strings. Array containing names of each document, in the same order as above.</p>
<p><span class="bold">docDescriptions:</span> An array of strings. Document descriptions, if any, in the same order as above. For folders, this field is empty.</p>
<p><span class="bold">docPlanTypes:</span> An array of strings. Plantype information for each document, in the same order as above. For folders, this field is empty.</p>
<p><span class="bold">docAttributes:</span> An array of strings. Attribute information for each document, in the same order as above. For folders, this field is empty. For forms, this field can be any of the following:</p>
<p>Enum FORM_ATTRIBUTES</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>NO_ATTRIBUTE = -1 (for a folder)</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>HFM_BASIC_FORM = 0</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>ADHOC_ENABLED = 8 (basic form)</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>COMPOSITE_FORM = 16</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>SMART_FORM = 128</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>SAVED_ADHOC_GRID = 40</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>SAVED_ADHOC_EXCLUSIVE_GRID = 104</p>
<p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>SMART_FORM_ADHOC_ENABLED = 136</p>
<p>End Enum</p>
<p>HypListDocuments sends these values back as strings. See <a href="hyplistdatabases_105x78a7eea3.htm#GUID-505ACBA5-70D2-41CE-A0A8-0F88D72645D1__section-1-78A78ADB">Example</a>.</p>
<p>Note that a folder has only a name associated with it. Other information is only available for forms.</p>
</div>
<!-- class="section" -->
<div class="section" id="GUID-895607D3-0AB0-4DA1-9F87-C6E7856A2F3E__section-125-36d015f6">
<p class="subhead1">Return Value</p>
<p>Returns 0 if successful; otherwise, returns the appropriate error code.</p>
</div>
<!-- class="section" -->
<div class="section" id="GUID-895607D3-0AB0-4DA1-9F87-C6E7856A2F3E__section-126-36d02a2f">
<p class="subhead1">Example</p>
<p>The following VBA can be used directly, using each of the invocations one by one.</p>
<pre dir="ltr">
Sub testListDocs()

Dim ret As Integer
Dim firstDocType
Dim vtDocs As DOC_Info
Dim vtAttr

'Usage with connection information as given for HypConnect()/HypUIConect()
ret = HypListDocuments("", "&lt;user_name&gt;", "&lt;password&gt;", "http://&lt;server_url&gt;:&lt;port&gt;/HyperionPlanning/SmartView|&lt;server&gt;|EPBCS|", "/&lt;path&gt;", vtDocs)

'Usage with friendly private connection name.
'ret = HypListDocuments("", "&lt;user_name", "&lt;password&gt;", "&lt;server&gt;", "/&lt;path&gt;", vtDocs)

'Usage with connection information present in Sheet1.
'ret = HypListDocuments("Sheet1", "&lt;user_name&gt;", "&lt;password&gt;", "", "/&lt;path&gt;", vtDocs)

'Usage with active data source
'ret = HypListDocuments("", "&lt;user_name&gt;", "&lt;password&gt;", "", "/&lt;path&gt;", vtDocs)

MsgBox "Total no. of docs is : " &amp; vtDocs.numDocs

If vtDocs.numDocs &gt; 0 Then
   'First, folder info is sent, and then forms info.
   firstDocType = vtDocs.docTypes(0)

   If vtDocs.docTypes(0) = HYP_LIST_DOC_FORM Then
      MsgBox "First doc is a form."
   Else
      MsgBox "First doc is a folder."
   End If

   MsgBox "First doc name is : " &amp; vtDocs.docNames(0)

   MsgBox "First doc attribute is : " &amp; vtDocs.docAttributes(0)

   'Need to convert attribute string to integer before comparison.
   vtAttr = CInt(vtDocs.docAttributes(0))

   If vtAttr &lt;&gt; NO_ATTRIBUTE Then

      If vtAttr = ADHOC_ENABLED Then
         MsgBox "This form is adhoc-enabled"
      End If

      If vtAttr = SAVED_ADHOC_GRID Then
         MsgBox "This is a saved ad-hoc grid"
      End If

      If vtAttr = SAVED_ADHOC_EXCLUSIVE_GRID Then
         MsgBox "This is a saved ad-hoc exclusive grid"
      End If

      If vtAttr = COMPOSITE_FORM Then
         MsgBox "This is a composite form."
      Else
         MsgBox "This is not a composite form."
      End If

   End If

End If
End Sub
</pre></div>
<!-- class="section" --></div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment43">
<tr>
<td class="cellalignment50">
<table class="cellalignment53">
<tr>
<td class="cellalignment47"><a href="hypgetsheetinfo_107x78a8472e.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment47"><a href="connection_functions.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2004, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment52">
<table class="cellalignment46">
<tr>
<td class="cellalignment47"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment47"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
